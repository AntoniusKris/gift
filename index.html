<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wedding Gift</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ---------- BASE ---------- */
body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #f7efe5, #efe1d1);
  font-family: Georgia, serif;
  color: #4a3f35;
  overflow: hidden;
}

.container {
  text-align: center;
  position: relative;
  z-index: 2;
}

.instruction {
  font-size: 18px;
  margin-bottom: 20px;
}

.gift {
  width: 160px;
  cursor: pointer;
}

.gift.idle:hover {
  animation: shake-slow 0.35s infinite;
}

/* ---------- ANIMATIONS ---------- */
@keyframes shake-slow {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(3deg); }
  75% { transform: rotate(-3deg); }
}

@keyframes shake-fast {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(6deg); }
  75% { transform: rotate(-6deg); }
}

.zooming {
  animation: zoomIn 5s forwards;
}

@keyframes zoomIn {
  to { transform: scale(2.2); }
}

.shaking-fast {
  animation: shake-fast 0.1s infinite;
}

.explode {
  animation: explode 0.5s forwards;
}

@keyframes explode {
  to { transform: scale(3); opacity: 0; }
}

/* ---------- COUNTER ---------- */
.counter {
  margin-top: 12px;
  font-size: 14px;
  opacity: 0.7;
}

.failed {
  color: #b00020;
  margin-top: 12px;
}

/* ---------- MESSAGE ---------- */
.message {
  display: none;
  background: rgba(255,255,255,0.75);
  backdrop-filter: blur(10px);
  margin-top: 30px;
  padding: 30px;
  border-radius: 16px;
  max-width: 600px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  animation: fadeText 3s ease forwards;
}

@keyframes fadeText {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ---------- BACKGROUND SLIDES ---------- */
.bg-slideshow {
  position: fixed;
  inset: 0;
  z-index: 0;
}

.bg-slide {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  opacity: 0;
  transform: scale(1);
  transition: opacity 2s ease;
}

.bg-slide.active {
  opacity: 1;
  animation: zoomBg 10s linear forwards;
}

@keyframes zoomBg {
  to { transform: scale(1.1); }
}

/* ---------- CONFETTI ---------- */
.confetti {
  position: absolute;
  width: 10px;
  height: 10px;
  top: -10px;
  animation: fall linear forwards;
}

@keyframes fall {
  to { transform: translateY(110vh) rotate(720deg); }
}

/* ---------- MUSIC BUTTON ---------- */
.music-btn {
  margin-top: 20px;
  padding: 8px 16px;
  border: none;
  border-radius: 20px;
  background: #4a3f35;
  color: #fff;
  cursor: pointer;
  font-size: 14px;
}
</style>
</head>

<body>

<!-- Background -->
<div class="bg-slideshow">
  <div class="bg-slide" style="background-image:url('bg1.jpeg')"></div>
  <div class="bg-slide" style="background-image:url('bg2.jpeg')"></div>
  <div class="bg-slide" style="background-image:url('bg3.jpeg')"></div>
</div>

<!-- Audio -->
<audio id="bgMusic" loop>
  <source src="wedding-music.mp3" type="audio/mpeg">
</audio>

<div class="container">
  <div class="instruction">üéÅ Tap <strong>27 times continuously</strong></div>

  <img id="gift" class="gift idle"
  src="data:image/svg+xml;utf8,
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'>
    <rect x='30' y='70' width='140' height='100' rx='12' fill='%23c94c4c'/>
    <rect x='90' y='70' width='20' height='100' fill='%23f5d76e'/>
    <rect x='30' y='105' width='140' height='20' fill='%23f5d76e'/>
    <rect x='30' y='50' width='140' height='30' rx='10' fill='%23a83c3c'/>
    <circle cx='100' cy='45' r='15' fill='%23f5d76e'/>
  </svg>">

  <div class="counter" id="counter">0 / 27</div>
  <div class="failed" id="failed"></div>

  <div class="message" id="message">
    <h1>Happy Wedding Day</h1>
    <h2>Jyesta & Nunil</h2>
    <p>
      May your love grow stronger every day,  
      your friendship remain your foundation,  
      and your home be filled with peace and joy.
    </p>
    <p><em>With love,<br>Your best friend</em></p>

    <button class="music-btn" id="musicBtn">‚è∏ Pause Music</button>
  </div>
</div>

<script>
/* ---------- TAP LOGIC ---------- */
const gift = document.getElementById("gift");
const counter = document.getElementById("counter");
const failed = document.getElementById("failed");
const message = document.getElementById("message");

const MAX_DELAY = 200;
const REQUIRED_TAPS = 27;

let taps = 0;
let lastTap = null;
let timer = null;
let opened = false;

gift.onclick = () => {
  if (opened) return;
  const now = Date.now();
  if (lastTap && now - lastTap > MAX_DELAY) return check();
  lastTap = now;
  taps++;
  counter.textContent = taps + " / 27";
  if (taps > REQUIRED_TAPS) return reset("‚ùå Too many taps");
  clearTimeout(timer);
  timer = setTimeout(check, MAX_DELAY + 10);
};

function reset(msg) {
  taps = 0;
  lastTap = null;
  counter.textContent = "0 / 27";
  failed.textContent = msg;
}

function check() {
  if (taps === REQUIRED_TAPS) openGift();
  else reset("‚ùå Must be exactly 27 taps");
}

/* ---------- OPEN SEQUENCE ---------- */
const slides = document.querySelectorAll(".bg-slide");
const music = document.getElementById("bgMusic");
const btn = document.getElementById("musicBtn");
let slideIndex = 0;

function openGift() {
  opened = true;
  gift.classList.add("zooming");
  setTimeout(()=>gift.classList.add("shaking-fast"),2000);
  setTimeout(()=>gift.classList.add("explode"),5000);
  setTimeout(showMessage,5500);
}

function showMessage() {
  gift.style.display="none";
  counter.style.display="none";
  message.style.display="block";
  startSlideshow();
  fadeInMusic();
}

/* ---------- BACKGROUND ---------- */
function startSlideshow(){
  slides[0].classList.add("active");
  setInterval(()=>{
    slides[slideIndex].classList.remove("active");
    slideIndex=(slideIndex+1)%slides.length;
    slides[slideIndex].classList.add("active");
  },10000);
}

/* ---------- MUSIC ---------- */
function fadeInMusic(){
  music.volume = 0;
  music.play();
  let v = 0;
  const fade = setInterval(()=>{
    v += 0.02;
    music.volume = Math.min(v,0.6);
    if (v >= 0.6) clearInterval(fade);
  },100);
}

btn.onclick = ()=>{
  if (music.paused){ music.play(); btn.textContent="‚è∏ Pause Music"; }
  else { music.pause(); btn.textContent="‚ñ∂ Play Music"; }
};
</script>

</body>
</html>
